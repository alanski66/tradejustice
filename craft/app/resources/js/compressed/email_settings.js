!function(e){var i=Garnish.Base.extend({$form:null,$protocolField:null,$protocolSelect:null,$hiddenFields:null,$testBtn:null,$testSpinner:null,$protocolSettingsPane:null,$protocolSettingsPaneHead:null,$protocolSettingsPaneBody:null,protocol:null,init:function(){this.$form=e("#container"),this.$protocolField=e("#protocol-field"),this.$protocolSelect=e("#protocol"),this.$hiddenFields=e("#hidden-fields"),this.$testBtn=e("#test"),this.$testSpinner=e("#test-spinner"),this._onEmailTypeChange(),this.addListener(this.$protocolSelect,"change","_onEmailTypeChange"),this.addListener(this.$testBtn,"activate","sendTestEmail")},getField:function(t){return e("#"+i.protocolFields[this.protocol][t]+"-field")},_onEmailTypeChange:function(){if(this.protocol&&this.protocol in i.protocolFields)for(var t=0;t<i.protocolFields[this.protocol].length;t++)this.getField(t).appendTo(this.$hiddenFields);if(this.protocol=this.$protocolSelect.val(),this.protocol in i.protocolFields)for(var e=this.$protocolField,o=0;o<i.protocolFields[this.protocol].length;o++){var s=this.getField(o);s.insertAfter(e),e=s}},sendTestEmail:function(){if(!this.$testBtn.hasClass("sel")){this.$testBtn.addClass("sel"),this.$testSpinner.removeClass("hidden");var t=Garnish.getPostData(this.$form);delete t.action,Craft.postActionRequest("systemSettings/testEmailSettings",t,e.proxy(function(t,e){this.$testBtn.removeClass("sel"),this.$testSpinner.addClass("hidden"),"success"==e&&(t.success?Craft.cp.displayNotice(Craft.t("Email sent successfully! Check your inbox.")):Craft.cp.displayError(t.error))},this))}}},{protocolFields:{smtp:["host","port","smtpKeepAlive","smtpAuth","smtpAuthCredentials","smtpSecureTransportType","timeout"],pop:["username","password","host","port","timeout"],gmail:["username","password"]}});Craft.emailSettingsForm=new i}(jQuery);
//# sourceMappingURL=email_settings.js.map